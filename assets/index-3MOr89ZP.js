(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();const sharedConfig={context:void 0,registry:void 0},equalFn=(i,t)=>i===t,$TRACK=Symbol("solid-track"),signalOptions={equals:equalFn};let runEffects=runQueue;const STALE=1,PENDING=2,UNOWNED={owned:null,cleanups:null,context:null,owner:null};var Owner=null;let Transition=null,ExternalSourceConfig=null,Listener=null,Updates=null,Effects=null,ExecCount=0;function createRoot(i,t){const n=Listener,s=Owner,r=i.length===0,l=t===void 0?s:t,o=r?UNOWNED:{owned:null,cleanups:null,context:l?l.context:null,owner:l},a=r?i:()=>i(()=>untrack(()=>cleanNode(o)));Owner=o,Listener=null;try{return runUpdates(a,!0)}finally{Listener=n,Owner=s}}function createSignal(i,t){t=t?Object.assign({},signalOptions,t):signalOptions;const n={value:i,observers:null,observerSlots:null,comparator:t.equals||void 0},s=r=>(typeof r=="function"&&(r=r(n.value)),writeSignal(n,r));return[readSignal.bind(n),s]}function createRenderEffect(i,t,n){const s=createComputation(i,t,!1,STALE);updateComputation(s)}function createEffect(i,t,n){runEffects=runUserEffects;const s=createComputation(i,t,!1,STALE);(!n||!n.render)&&(s.user=!0),Effects?Effects.push(s):updateComputation(s)}function createMemo(i,t,n){n=n?Object.assign({},signalOptions,n):signalOptions;const s=createComputation(i,t,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=n.equals||void 0,updateComputation(s),readSignal.bind(s)}function untrack(i){if(Listener===null)return i();const t=Listener;Listener=null;try{return i()}finally{Listener=t}}function onCleanup(i){return Owner===null||(Owner.cleanups===null?Owner.cleanups=[i]:Owner.cleanups.push(i)),i}function getOwner(){return Owner}function runWithOwner(i,t){const n=Owner,s=Listener;Owner=i,Listener=null;try{return runUpdates(t,!0)}catch(r){handleError(r)}finally{Owner=n,Listener=s}}function createContext(i,t){const n=Symbol("context");return{id:n,Provider:createProvider(n),defaultValue:i}}function useContext(i){return Owner&&Owner.context&&Owner.context[i.id]!==void 0?Owner.context[i.id]:i.defaultValue}function children(i){const t=createMemo(i),n=createMemo(()=>resolveChildren(t()));return n.toArray=()=>{const s=n();return Array.isArray(s)?s:s!=null?[s]:[]},n}function readSignal(){if(this.sources&&this.state)if(this.state===STALE)updateComputation(this);else{const i=Updates;Updates=null,runUpdates(()=>lookUpstream(this),!1),Updates=i}if(Listener){const i=this.observers?this.observers.length:0;Listener.sources?(Listener.sources.push(this),Listener.sourceSlots.push(i)):(Listener.sources=[this],Listener.sourceSlots=[i]),this.observers?(this.observers.push(Listener),this.observerSlots.push(Listener.sources.length-1)):(this.observers=[Listener],this.observerSlots=[Listener.sources.length-1])}return this.value}function writeSignal(i,t,n){let s=i.value;return(!i.comparator||!i.comparator(s,t))&&(i.value=t,i.observers&&i.observers.length&&runUpdates(()=>{for(let r=0;r<i.observers.length;r+=1){const l=i.observers[r],o=Transition&&Transition.running;o&&Transition.disposed.has(l),(o?!l.tState:!l.state)&&(l.pure?Updates.push(l):Effects.push(l),l.observers&&markDownstream(l)),o||(l.state=STALE)}if(Updates.length>1e6)throw Updates=[],new Error},!1)),t}function updateComputation(i){if(!i.fn)return;cleanNode(i);const t=ExecCount;runComputation(i,i.value,t)}function runComputation(i,t,n){let s;const r=Owner,l=Listener;Listener=Owner=i;try{s=i.fn(t)}catch(o){return i.pure&&(i.state=STALE,i.owned&&i.owned.forEach(cleanNode),i.owned=null),i.updatedAt=n+1,handleError(o)}finally{Listener=l,Owner=r}(!i.updatedAt||i.updatedAt<=n)&&(i.updatedAt!=null&&"observers"in i?writeSignal(i,s):i.value=s,i.updatedAt=n)}function createComputation(i,t,n,s=STALE,r){const l={fn:i,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:Owner,context:Owner?Owner.context:null,pure:n};return Owner===null||Owner!==UNOWNED&&(Owner.owned?Owner.owned.push(l):Owner.owned=[l]),l}function runTop(i){if(i.state===0)return;if(i.state===PENDING)return lookUpstream(i);if(i.suspense&&untrack(i.suspense.inFallback))return i.suspense.effects.push(i);const t=[i];for(;(i=i.owner)&&(!i.updatedAt||i.updatedAt<ExecCount);)i.state&&t.push(i);for(let n=t.length-1;n>=0;n--)if(i=t[n],i.state===STALE)updateComputation(i);else if(i.state===PENDING){const s=Updates;Updates=null,runUpdates(()=>lookUpstream(i,t[0]),!1),Updates=s}}function runUpdates(i,t){if(Updates)return i();let n=!1;t||(Updates=[]),Effects?n=!0:Effects=[],ExecCount++;try{const s=i();return completeUpdates(n),s}catch(s){n||(Effects=null),Updates=null,handleError(s)}}function completeUpdates(i){if(Updates&&(runQueue(Updates),Updates=null),i)return;const t=Effects;Effects=null,t.length&&runUpdates(()=>runEffects(t),!1)}function runQueue(i){for(let t=0;t<i.length;t++)runTop(i[t])}function runUserEffects(i){let t,n=0;for(t=0;t<i.length;t++){const s=i[t];s.user?i[n++]=s:runTop(s)}for(t=0;t<n;t++)runTop(i[t])}function lookUpstream(i,t){i.state=0;for(let n=0;n<i.sources.length;n+=1){const s=i.sources[n];if(s.sources){const r=s.state;r===STALE?s!==t&&(!s.updatedAt||s.updatedAt<ExecCount)&&runTop(s):r===PENDING&&lookUpstream(s,t)}}}function markDownstream(i){for(let t=0;t<i.observers.length;t+=1){const n=i.observers[t];n.state||(n.state=PENDING,n.pure?Updates.push(n):Effects.push(n),n.observers&&markDownstream(n))}}function cleanNode(i){let t;if(i.sources)for(;i.sources.length;){const n=i.sources.pop(),s=i.sourceSlots.pop(),r=n.observers;if(r&&r.length){const l=r.pop(),o=n.observerSlots.pop();s<r.length&&(l.sourceSlots[o]=s,r[s]=l,n.observerSlots[s]=o)}}if(i.owned){for(t=i.owned.length-1;t>=0;t--)cleanNode(i.owned[t]);i.owned=null}if(i.cleanups){for(t=i.cleanups.length-1;t>=0;t--)i.cleanups[t]();i.cleanups=null}i.state=0}function castError(i){return i instanceof Error?i:new Error(typeof i=="string"?i:"Unknown error",{cause:i})}function handleError(i,t=Owner){throw castError(i)}function resolveChildren(i){if(typeof i=="function"&&!i.length)return resolveChildren(i());if(Array.isArray(i)){const t=[];for(let n=0;n<i.length;n++){const s=resolveChildren(i[n]);Array.isArray(s)?t.push.apply(t,s):t.push(s)}return t}return i}function createProvider(i,t){return function(s){let r;return createRenderEffect(()=>r=untrack(()=>(Owner.context={...Owner.context,[i]:s.value},children(()=>s.children))),void 0),r}}const FALLBACK=Symbol("fallback");function dispose(i){for(let t=0;t<i.length;t++)i[t]()}function mapArray(i,t,n={}){let s=[],r=[],l=[],o=0,a=t.length>1?[]:null;return onCleanup(()=>dispose(l)),()=>{let c=i()||[],h,u;return c[$TRACK],untrack(()=>{let p=c.length,f,g,m,k,y,x,b,w,$;if(p===0)o!==0&&(dispose(l),l=[],s=[],r=[],o=0,a&&(a=[])),n.fallback&&(s=[FALLBACK],r[0]=createRoot(v=>(l[0]=v,n.fallback())),o=1);else if(o===0){for(r=new Array(p),u=0;u<p;u++)s[u]=c[u],r[u]=createRoot(d);o=p}else{for(m=new Array(p),k=new Array(p),a&&(y=new Array(p)),x=0,b=Math.min(o,p);x<b&&s[x]===c[x];x++);for(b=o-1,w=p-1;b>=x&&w>=x&&s[b]===c[w];b--,w--)m[w]=r[b],k[w]=l[b],a&&(y[w]=a[b]);for(f=new Map,g=new Array(w+1),u=w;u>=x;u--)$=c[u],h=f.get($),g[u]=h===void 0?-1:h,f.set($,u);for(h=x;h<=b;h++)$=s[h],u=f.get($),u!==void 0&&u!==-1?(m[u]=r[h],k[u]=l[h],a&&(y[u]=a[h]),u=g[u],f.set($,u)):l[h]();for(u=x;u<p;u++)u in m?(r[u]=m[u],l[u]=k[u],a&&(a[u]=y[u],a[u](u))):r[u]=createRoot(d);r=r.slice(0,o=p),s=c.slice(0)}return r});function d(p){if(l[u]=p,a){const[f,g]=createSignal(u);return a[u]=g,t(c[u],f)}return t(c[u])}}}function createComponent(i,t){return untrack(()=>i(t||{}))}const narrowedError=i=>`Stale read from <${i}>.`;function For(i){const t="fallback"in i&&{fallback:()=>i.fallback};return createMemo(mapArray(()=>i.each,i.children,t||void 0))}function Show(i){const t=i.keyed,n=createMemo(()=>i.when,void 0,{equals:(s,r)=>t?s===r:!s==!r});return createMemo(()=>{const s=n();if(s){const r=i.children;return typeof r=="function"&&r.length>0?untrack(()=>r(t?s:()=>{if(!untrack(n))throw narrowedError("Show");return i.when})):r}return i.fallback},void 0,void 0)}function reconcileArrays(i,t,n){let s=n.length,r=t.length,l=s,o=0,a=0,c=t[r-1].nextSibling,h=null;for(;o<r||a<l;){if(t[o]===n[a]){o++,a++;continue}for(;t[r-1]===n[l-1];)r--,l--;if(r===o){const u=l<s?a?n[a-1].nextSibling:n[l-a]:c;for(;a<l;)i.insertBefore(n[a++],u)}else if(l===a)for(;o<r;)(!h||!h.has(t[o]))&&t[o].remove(),o++;else if(t[o]===n[l-1]&&n[a]===t[r-1]){const u=t[--r].nextSibling;i.insertBefore(n[a++],t[o++].nextSibling),i.insertBefore(n[--l],u),t[r]=n[l]}else{if(!h){h=new Map;let d=a;for(;d<l;)h.set(n[d],d++)}const u=h.get(t[o]);if(u!=null)if(a<u&&u<l){let d=o,p=1,f;for(;++d<r&&d<l&&!((f=h.get(t[d]))==null||f!==u+p);)p++;if(p>u-a){const g=t[o];for(;a<u;)i.insertBefore(n[a++],g)}else i.replaceChild(n[a++],t[o++])}else o++;else t[o++].remove()}}}const $$EVENTS="_$DX_DELEGATE";function render(i,t,n,s={}){let r;return createRoot(l=>{r=l,t===document?i():insert(t,i(),t.firstChild?null:void 0,n)},s.owner),()=>{r(),t.textContent=""}}function template(i,t,n){let s;const r=()=>{const o=document.createElement("template");return o.innerHTML=i,n?o.content.firstChild.firstChild:o.content.firstChild},l=t?()=>untrack(()=>document.importNode(s||(s=r()),!0)):()=>(s||(s=r())).cloneNode(!0);return l.cloneNode=l,l}function delegateEvents(i,t=window.document){const n=t[$$EVENTS]||(t[$$EVENTS]=new Set);for(let s=0,r=i.length;s<r;s++){const l=i[s];n.has(l)||(n.add(l),t.addEventListener(l,eventHandler))}}function setAttribute(i,t,n){n==null?i.removeAttribute(t):i.setAttribute(t,n)}function className(i,t){t==null?i.removeAttribute("class"):i.className=t}function addEventListener(i,t,n,s){if(s)Array.isArray(n)?(i[`$$${t}`]=n[0],i[`$$${t}Data`]=n[1]):i[`$$${t}`]=n;else if(Array.isArray(n)){const r=n[0];i.addEventListener(t,n[0]=l=>r.call(i,n[1],l))}else i.addEventListener(t,n)}function insert(i,t,n,s){if(n!==void 0&&!s&&(s=[]),typeof t!="function")return insertExpression(i,t,s,n);createRenderEffect(r=>insertExpression(i,t(),r,n),s)}function eventHandler(i){const t=`$$${i.type}`;let n=i.composedPath&&i.composedPath()[0]||i.target;for(i.target!==n&&Object.defineProperty(i,"target",{configurable:!0,value:n}),Object.defineProperty(i,"currentTarget",{configurable:!0,get(){return n||document}});n;){const s=n[t];if(s&&!n.disabled){const r=n[`${t}Data`];if(r!==void 0?s.call(n,r,i):s.call(n,i),i.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function insertExpression(i,t,n,s,r){for(;typeof n=="function";)n=n();if(t===n)return n;const l=typeof t,o=s!==void 0;if(i=o&&n[0]&&n[0].parentNode||i,l==="string"||l==="number")if(l==="number"&&(t=t.toString()),o){let a=n[0];a&&a.nodeType===3?a.data!==t&&(a.data=t):a=document.createTextNode(t),n=cleanChildren(i,n,s,a)}else n!==""&&typeof n=="string"?n=i.firstChild.data=t:n=i.textContent=t;else if(t==null||l==="boolean")n=cleanChildren(i,n,s);else{if(l==="function")return createRenderEffect(()=>{let a=t();for(;typeof a=="function";)a=a();n=insertExpression(i,a,n,s)}),()=>n;if(Array.isArray(t)){const a=[],c=n&&Array.isArray(n);if(normalizeIncomingArray(a,t,n,r))return createRenderEffect(()=>n=insertExpression(i,a,n,s,!0)),()=>n;if(a.length===0){if(n=cleanChildren(i,n,s),o)return n}else c?n.length===0?appendNodes(i,a,s):reconcileArrays(i,n,a):(n&&cleanChildren(i),appendNodes(i,a));n=a}else if(t.nodeType){if(Array.isArray(n)){if(o)return n=cleanChildren(i,n,s,t);cleanChildren(i,n,null,t)}else n==null||n===""||!i.firstChild?i.appendChild(t):i.replaceChild(t,i.firstChild);n=t}}return n}function normalizeIncomingArray(i,t,n,s){let r=!1;for(let l=0,o=t.length;l<o;l++){let a=t[l],c=n&&n[l],h;if(!(a==null||a===!0||a===!1))if((h=typeof a)=="object"&&a.nodeType)i.push(a);else if(Array.isArray(a))r=normalizeIncomingArray(i,a,c)||r;else if(h==="function")if(s){for(;typeof a=="function";)a=a();r=normalizeIncomingArray(i,Array.isArray(a)?a:[a],Array.isArray(c)?c:[c])||r}else i.push(a),r=!0;else{const u=String(a);c&&c.nodeType===3&&c.data===u?i.push(c):i.push(document.createTextNode(u))}}return r}function appendNodes(i,t,n=null){for(let s=0,r=t.length;s<r;s++)i.insertBefore(t[s],n)}function cleanChildren(i,t,n,s){if(n===void 0)return i.textContent="";const r=s||document.createTextNode("");if(t.length){let l=!1;for(let o=t.length-1;o>=0;o--){const a=t[o];if(r!==a){const c=a.parentNode===i;!l&&!o?c?i.replaceChild(r,a):i.insertBefore(r,n):c&&a.remove()}else l=!0}}else i.insertBefore(r,n);return[r]}const SVG_NAMESPACE="http://www.w3.org/2000/svg";function createElement(i,t=!1){return t?document.createElementNS(SVG_NAMESPACE,i):document.createElement(i)}function Portal(i){const{useShadow:t}=i,n=document.createTextNode(""),s=()=>i.mount||document.body,r=getOwner();let l,o=!!sharedConfig.context;return createEffect(()=>{l||(l=runWithOwner(r,()=>createMemo(()=>i.children)));const a=s();if(a instanceof HTMLHeadElement){const[c,h]=createSignal(!1),u=()=>h(!0);createRoot(d=>insert(a,()=>c()?d():l(),null)),onCleanup(u)}else{const c=createElement(i.isSVG?"g":"div",i.isSVG),h=t&&c.attachShadow?c.attachShadow({mode:"open"}):c;Object.defineProperty(c,"_$host",{get(){return n.parentNode},configurable:!0}),insert(h,l),a.appendChild(c),i.ref&&i.ref(c),onCleanup(()=>a.removeChild(c))}},void 0,{render:!o}),n}const header="_header_1o1z5_15",link$1="_link_1o1z5_26",layout="_layout_1o1z5_30",layoutTask="_layoutTask_1o1z5_37",layoutBoard="_layoutBoard_1o1z5_43",styles$h={header,link:link$1,layout,layoutTask,layoutBoard},StoreContext=createContext(),useStore=()=>{const i=useContext(StoreContext);return i||console.error("Failed to load store, wrap component into StoreContext"),i},taskMethods={serialize:i=>({...i,postponedUntil:i.postponedUntil?i.postponedUntil.valueOf():null}),deserialize:i=>{const t=typeof i=="string"?JSON.parse(i):i;return{...t,postponedUntil:t.postponedUntil?new Date(t.postponedUntil):null}}},EMPTY_ARRAY=[];function mapHash(i,t){return Object.fromEntries(Object.entries(i).map(([n,s])=>[n,t(s)]))}const hasChild=(i,t,n)=>{const s=[i],r={};for(;s.length>0;){const l=s.shift();if(!l||r[l])continue;if(r[l]=!0,l===t)return!0;const o=n[l];if(o)for(let a=0;a<o.length;a++){const c=o[a];s.push(c)}}return!1};function isEveryLeafDelayed(i,t){const n=i.tasks[t],s=i.children[t]||[];let r=[];for(let a=0;a<s.length;a++){const c=s[a];i.tasks[c].isDone||r.push(c)}if(r.length==0)if(n.postponedUntil){if(n.postponedUntil>new Date)return n.postponedUntil}else return null;let l=!0,o=null;for(let a=0;a<r.length;a++){const c=r[a],h=isEveryLeafDelayed(i,c);h?o=nullableMinDate(o,h):l=!1}return l?o:null}function isSubTreeDelayed(i,t){const n=i.tasks[t],s=i.children[t]||[];let r=[];for(let l=0;l<s.length;l++){const o=s[l];i.tasks[o].isDone==!1&&r.push(o)}if(r.length==0)return n.postponedUntil?n.postponedUntil>new Date:!1;for(let l=0;l<r.length;l++){const o=r[l];if(!isSubTreeDelayed(i,o))return!1}return!0}function nullableMinDate(i,t){return i==null?t:t==null?i:new Date(Math.min(i.valueOf(),t.valueOf()))}class InMemoryStore{rootId;tasks={};tasksSignals={};children={};parents={};incId;onChange=[];constructor(t){this.rootId=t,this.incId=t;const n=localStorage.getItem("tasks");n&&this.updateFromJSON(n)}updateFromJSON(t){const n=JSON.parse(t);this.tasks=mapHash(n.tasks,taskMethods.deserialize),this.tasksSignals=mapHash(this.tasks,r=>{const[l,o]=createSignal(r);return{get:l,set:o}}),this.children=n.children,this.rootId=n.rootId,this.incId=n.incId;const s=Object.keys(this.children).map(r=>parseInt(r,10));for(let r=0;r<s.length;r++){const l=s[r],o=this.children[l];for(let a=0;a<o.length;a++){const c=o[a];this.parents[c]??=[],this.parents[c].includes(l)||this.parents[c].push(l)}}this.cleanDeleted(),this.trigger()}cleanDeleted(){const t=Object.values(this.tasks);for(let n=0;n<t.length;n++){const s=t[n];this.rootId!==s.id&&(!this.parents[s.id]||this.parents[s.id].length===0)&&(delete this.tasks[s.id],delete this.children[s.id])}}save(){localStorage.setItem("tasks",JSON.stringify({tasks:mapHash(this.tasks,taskMethods.serialize),children:this.children,rootId:this.rootId,incId:this.incId}))}trigger(){this.save();const t=this.onChange.slice(0);for(let n=0;n<t.length;n++){const s=t[n];this.onChange.find(r=>r===s)&&s()}}genId(){return this.incId++,this.incId}generateRootId(){this.rootId=1}onUpdate(t){this.onChange.push(t),onCleanup(()=>{this.onChange=this.onChange.filter(n=>n!=t)})}getRootId(){return this.rootId}setTask(t){if(this.tasks[t.id]=t,!this.tasksSignals[t.id]){const[n,s]=createSignal(t);this.tasksSignals[t.id]={get:n,set:s}}this.tasksSignals[t.id].set(t),this.trigger()}createTask(t,n){const s={id:this.genId(),isDone:!1,postponedUntil:null,...n};return this.setTask(s),this.link(s.id,t),this.trigger(),s}getChildren(t){const n=this.children[t]||EMPTY_ARRAY,[s,r]=createSignal(n);return this.onUpdate(()=>{r(this.children[t]||EMPTY_ARRAY)}),s}getParents(t){const n=this.parents[t]||EMPTY_ARRAY,[s,r]=createSignal(n);return this.onUpdate(()=>{r(this.parents[t]||EMPTY_ARRAY)}),s}getTask(t){if(t===this.getRootId()){if(this.tasksSignals[t])return this.tasksSignals[t].get;const n={id:t,title:"Root",description:"",result:"",isDone:!1,postponedUntil:null,isPriorityList:!1};this.setTask(n);const[s]=createSignal(n);return s}return this.tasksSignals[t].get}unlink(t,n){const s=this.children[n];s&&(this.children[n]=s.filter(r=>r!=t)),this.parents[t]??=[],this.parents[t]=this.parents[t].filter(r=>r!==n),this.trigger()}rearrange(t,n,s){const r=this.children[n],l=r.findIndex(a=>a===s),o=r.findIndex(a=>a===t);l<o?this.children[n]=[...r.slice(0,l),t,s,...r.slice(l+1,o),...r.slice(o+1)]:this.children[n]=[...r.slice(0,o),...r.slice(o+1,l),s,t,...r.slice(l+1)],this.trigger()}link(t,n,s){if(t==n||t===s)return;const r=this.children[n]||[];if(r.findIndex(l=>l===t)!=-1){s&&this.rearrange(t,n,s);return}hasChild(t,n,this.children)||(this.children[n]=[...r,t],this.parents[t]=[...this.parents[t]??[],n],this.trigger())}setDone(t,n){const s=this.tasks[t];this.setTask({...s,isDone:n})}setIsPriorityList(t,n){const s=this.tasks[t];this.setTask({...s,isPriorityList:n})}setTitle(t,n){const s=this.tasks[t];this.setTask({...s,title:n})}setDescription(t,n){const s=this.tasks[t];this.setTask({...s,description:n})}setResult(t,n){const s=this.tasks[t];this.setTask({...s,result:n})}getTree(t,n,s){const[r,l]=createSignal({relations:[],unlocked:[],updatedTime:new Date}),o=()=>{const a=[{id:t,priority:2}],c={},h=[],u=[],d={};let p=null;for(;a.length>0;){const g=a.shift();if(!g)continue;const{id:m,priority:k}=g;if(c[m]&&c[m]>k)continue;c[m]=k;const y=this.children[m];if((!y||y.length===0||!n&&y.every(x=>this.tasks[x].isDone))&&(d[m]||(u.push(m),d[m]=!0)),y){const b=this.tasks[m]?this.tasks[m].isPriorityList:!1;let w=!0;for(let $=0;$<y.length;$++){const v=y[$];if(s){const T=isEveryLeafDelayed(this,v);if(T){p=nullableMinDate(p,T);continue}}const _=this.tasks[v];if(_&&!n&&_.isDone)continue;const C=_.isDone;h.push({taskId:m,dependsOnId:v}),a.unshift({id:v,priority:C?1:w||!b?k:1}),C||isSubTreeDelayed(this,v)||(w=!1)}}}const f=[];for(let g=0;g<u.length;g++){const m=u[g];if(c[m]!==2)continue;const k=this.tasks[m];if(k&&k.postponedUntil&&k.postponedUntil>new Date){p=nullableMinDate(p,k.postponedUntil);continue}f.push(m)}p&&setTimeout(()=>{o()},p.valueOf()-new Date().valueOf()),l({relations:h,unlocked:f,updatedTime:new Date})};return o(),this.onUpdate(o),r}postpone(t,n){const s=this.tasks[t];this.setTask({...s,postponedUntil:n})}}class UIState{openedTask;_setOpenedTask;goalTask;_setGoalTask;shift;_setShift;flipHorizontally;_setFlipHorizontally;hideBlockedSubTree;_setHideBlockedSubTree;showCompleted;_setShowCompleted;constructor(){const[t,n]=createSignal(null);this.openedTask=t,this._setOpenedTask=n;const[s,r]=createSignal(null);this._setGoalTask=r,this.goalTask=s;const[l,o]=createSignal(!1);this.shift=l,this._setShift=o;const[a,c]=createSignal(!1);this.flipHorizontally=a,this._setFlipHorizontally=c;const[h,u]=createSignal(!1);this.hideBlockedSubTree=h,this._setHideBlockedSubTree=u;const[d,p]=createSignal(!1);this.showCompleted=d,this._setShowCompleted=p;const f=localStorage.getItem("uistate");if(f){const g=JSON.parse(f);this._setOpenedTask(g.openedTask),this._setGoalTask(g.goalTask),this._setShift(g.shift),this._setFlipHorizontally(g.flipHorizontally),this._setHideBlockedSubTree(g.hideBlockedSubTree),this._setShowCompleted(g.showCompleted)}}saveState(){localStorage.setItem("uistate",JSON.stringify({openedTask:this.openedTask(),goalTask:this.goalTask(),shift:this.shift(),flipHorizontally:this.flipHorizontally(),hideBlockedSubTree:this.hideBlockedSubTree(),showCompleted:this.showCompleted()}))}setGoalTask(t){this._setGoalTask(t),this.saveState()}setOpenedTask(t){this._setOpenedTask(t),this.saveState()}setShift(t){this._setShift(t),this.saveState()}setFlipHorizontally(t){this._setFlipHorizontally(t),this.saveState()}setHideBlockedSubtree(t){this._setHideBlockedSubTree(t),this.saveState()}setShowCompleted(t){this._setShowCompleted(t),this.saveState()}}const UIStateContext=createContext(),useUIState=()=>{const i=useContext(UIStateContext);return i||console.error("Failed to load ui state"),i},cont$1="_cont_75lcr_1",styles$g={cont:cont$1};function _getDefaults(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let _defaults=_getDefaults();function changeDefaults(i){_defaults=i}const escapeTest=/[&<>"']/,escapeReplace=new RegExp(escapeTest.source,"g"),escapeTestNoEncode=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode=new RegExp(escapeTestNoEncode.source,"g"),escapeReplacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},getEscapeReplacement=i=>escapeReplacements[i];function escape$1(i,t){if(t){if(escapeTest.test(i))return i.replace(escapeReplace,getEscapeReplacement)}else if(escapeTestNoEncode.test(i))return i.replace(escapeReplaceNoEncode,getEscapeReplacement);return i}const unescapeTest=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function unescape(i){return i.replace(unescapeTest,(t,n)=>(n=n.toLowerCase(),n==="colon"?":":n.charAt(0)==="#"?n.charAt(1)==="x"?String.fromCharCode(parseInt(n.substring(2),16)):String.fromCharCode(+n.substring(1)):""))}const caret=/(^|[^\[])\^/g;function edit(i,t){let n=typeof i=="string"?i:i.source;t=t||"";const s={replace:(r,l)=>{let o=typeof l=="string"?l:l.source;return o=o.replace(caret,"$1"),n=n.replace(r,o),s},getRegex:()=>new RegExp(n,t)};return s}function cleanUrl(i){try{i=encodeURI(i).replace(/%25/g,"%")}catch{return null}return i}const noopTest={exec:()=>null};function splitCells(i,t){const n=i.replace(/\|/g,(l,o,a)=>{let c=!1,h=o;for(;--h>=0&&a[h]==="\\";)c=!c;return c?"|":" |"}),s=n.split(/ \|/);let r=0;if(s[0].trim()||s.shift(),s.length>0&&!s[s.length-1].trim()&&s.pop(),t)if(s.length>t)s.splice(t);else for(;s.length<t;)s.push("");for(;r<s.length;r++)s[r]=s[r].trim().replace(/\\\|/g,"|");return s}function rtrim(i,t,n){const s=i.length;if(s===0)return"";let r=0;for(;r<s;){const l=i.charAt(s-r-1);if(l===t&&!n)r++;else if(l!==t&&n)r++;else break}return i.slice(0,s-r)}function findClosingBracket(i,t){if(i.indexOf(t[1])===-1)return-1;let n=0;for(let s=0;s<i.length;s++)if(i[s]==="\\")s++;else if(i[s]===t[0])n++;else if(i[s]===t[1]&&(n--,n<0))return s;return-1}function outputLink(i,t,n,s){const r=t.href,l=t.title?escape$1(t.title):null,o=i[1].replace(/\\([\[\]])/g,"$1");if(i[0].charAt(0)!=="!"){s.state.inLink=!0;const a={type:"link",raw:n,href:r,title:l,text:o,tokens:s.inlineTokens(o)};return s.state.inLink=!1,a}return{type:"image",raw:n,href:r,title:l,text:escape$1(o)}}function indentCodeCompensation(i,t){const n=i.match(/^(\s+)(?:```)/);if(n===null)return t;const s=n[1];return t.split(`
`).map(r=>{const l=r.match(/^\s+/);if(l===null)return r;const[o]=l;return o.length>=s.length?r.slice(s.length):r}).join(`
`)}class _Tokenizer{options;rules;lexer;constructor(t){this.options=t||_defaults}space(t){const n=this.rules.block.newline.exec(t);if(n&&n[0].length>0)return{type:"space",raw:n[0]}}code(t){const n=this.rules.block.code.exec(t);if(n){const s=n[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?s:rtrim(s,`
`)}}}fences(t){const n=this.rules.block.fences.exec(t);if(n){const s=n[0],r=indentCodeCompensation(s,n[3]||"");return{type:"code",raw:s,lang:n[2]?n[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):n[2],text:r}}}heading(t){const n=this.rules.block.heading.exec(t);if(n){let s=n[2].trim();if(/#$/.test(s)){const r=rtrim(s,"#");(this.options.pedantic||!r||/ $/.test(r))&&(s=r.trim())}return{type:"heading",raw:n[0],depth:n[1].length,text:s,tokens:this.lexer.inline(s)}}}hr(t){const n=this.rules.block.hr.exec(t);if(n)return{type:"hr",raw:rtrim(n[0],`
`)}}blockquote(t){const n=this.rules.block.blockquote.exec(t);if(n){let s=rtrim(n[0],`
`).split(`
`),r="",l="";const o=[];for(;s.length>0;){let a=!1;const c=[];let h;for(h=0;h<s.length;h++)if(/^ {0,3}>/.test(s[h]))c.push(s[h]),a=!0;else if(!a)c.push(s[h]);else break;s=s.slice(h);const u=c.join(`
`),d=u.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");r=r?`${r}
${u}`:u,l=l?`${l}
${d}`:d;const p=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,o,!0),this.lexer.state.top=p,s.length===0)break;const f=o[o.length-1];if(f?.type==="code")break;if(f?.type==="blockquote"){const g=f,m=g.raw+`
`+s.join(`
`),k=this.blockquote(m);o[o.length-1]=k,r=r.substring(0,r.length-g.raw.length)+k.raw,l=l.substring(0,l.length-g.text.length)+k.text;break}else if(f?.type==="list"){const g=f,m=g.raw+`
`+s.join(`
`),k=this.list(m);o[o.length-1]=k,r=r.substring(0,r.length-f.raw.length)+k.raw,l=l.substring(0,l.length-g.raw.length)+k.raw,s=m.substring(o[o.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:o,text:l}}}list(t){let n=this.rules.block.list.exec(t);if(n){let s=n[1].trim();const r=s.length>1,l={type:"list",raw:"",ordered:r,start:r?+s.slice(0,-1):"",loose:!1,items:[]};s=r?`\\d{1,9}\\${s.slice(-1)}`:`\\${s}`,this.options.pedantic&&(s=r?s:"[*+-]");const o=new RegExp(`^( {0,3}${s})((?:[	 ][^\\n]*)?(?:\\n|$))`);let a="",c="",h=!1;for(;t;){let u=!1;if(!(n=o.exec(t))||this.rules.block.hr.test(t))break;a=n[0],t=t.substring(a.length);let d=n[2].split(`
`,1)[0].replace(/^\t+/,y=>" ".repeat(3*y.length)),p=t.split(`
`,1)[0],f=0;this.options.pedantic?(f=2,c=d.trimStart()):(f=n[2].search(/[^ ]/),f=f>4?1:f,c=d.slice(f),f+=n[1].length);let g=!1;if(!d&&/^ *$/.test(p)&&(a+=p+`
`,t=t.substring(p.length+1),u=!0),!u){const y=new RegExp(`^ {0,${Math.min(3,f-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),x=new RegExp(`^ {0,${Math.min(3,f-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),b=new RegExp(`^ {0,${Math.min(3,f-1)}}(?:\`\`\`|~~~)`),w=new RegExp(`^ {0,${Math.min(3,f-1)}}#`);for(;t;){const $=t.split(`
`,1)[0];if(p=$,this.options.pedantic&&(p=p.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),b.test(p)||w.test(p)||y.test(p)||x.test(t))break;if(p.search(/[^ ]/)>=f||!p.trim())c+=`
`+p.slice(f);else{if(g||d.search(/[^ ]/)>=4||b.test(d)||w.test(d)||x.test(d))break;c+=`
`+p}!g&&!p.trim()&&(g=!0),a+=$+`
`,t=t.substring($.length+1),d=p.slice(f)}}l.loose||(h?l.loose=!0:/\n *\n *$/.test(a)&&(h=!0));let m=null,k;this.options.gfm&&(m=/^\[[ xX]\] /.exec(c),m&&(k=m[0]!=="[ ] ",c=c.replace(/^\[[ xX]\] +/,""))),l.items.push({type:"list_item",raw:a,task:!!m,checked:k,loose:!1,text:c,tokens:[]}),l.raw+=a}l.items[l.items.length-1].raw=a.trimEnd(),l.items[l.items.length-1].text=c.trimEnd(),l.raw=l.raw.trimEnd();for(let u=0;u<l.items.length;u++)if(this.lexer.state.top=!1,l.items[u].tokens=this.lexer.blockTokens(l.items[u].text,[]),!l.loose){const d=l.items[u].tokens.filter(f=>f.type==="space"),p=d.length>0&&d.some(f=>/\n.*\n/.test(f.raw));l.loose=p}if(l.loose)for(let u=0;u<l.items.length;u++)l.items[u].loose=!0;return l}}html(t){const n=this.rules.block.html.exec(t);if(n)return{type:"html",block:!0,raw:n[0],pre:n[1]==="pre"||n[1]==="script"||n[1]==="style",text:n[0]}}def(t){const n=this.rules.block.def.exec(t);if(n){const s=n[1].toLowerCase().replace(/\s+/g," "),r=n[2]?n[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",l=n[3]?n[3].substring(1,n[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):n[3];return{type:"def",tag:s,raw:n[0],href:r,title:l}}}table(t){const n=this.rules.block.table.exec(t);if(!n||!/[:|]/.test(n[2]))return;const s=splitCells(n[1]),r=n[2].replace(/^\||\| *$/g,"").split("|"),l=n[3]&&n[3].trim()?n[3].replace(/\n[ \t]*$/,"").split(`
`):[],o={type:"table",raw:n[0],header:[],align:[],rows:[]};if(s.length===r.length){for(const a of r)/^ *-+: *$/.test(a)?o.align.push("right"):/^ *:-+: *$/.test(a)?o.align.push("center"):/^ *:-+ *$/.test(a)?o.align.push("left"):o.align.push(null);for(let a=0;a<s.length;a++)o.header.push({text:s[a],tokens:this.lexer.inline(s[a]),header:!0,align:o.align[a]});for(const a of l)o.rows.push(splitCells(a,o.header.length).map((c,h)=>({text:c,tokens:this.lexer.inline(c),header:!1,align:o.align[h]})));return o}}lheading(t){const n=this.rules.block.lheading.exec(t);if(n)return{type:"heading",raw:n[0],depth:n[2].charAt(0)==="="?1:2,text:n[1],tokens:this.lexer.inline(n[1])}}paragraph(t){const n=this.rules.block.paragraph.exec(t);if(n){const s=n[1].charAt(n[1].length-1)===`
`?n[1].slice(0,-1):n[1];return{type:"paragraph",raw:n[0],text:s,tokens:this.lexer.inline(s)}}}text(t){const n=this.rules.block.text.exec(t);if(n)return{type:"text",raw:n[0],text:n[0],tokens:this.lexer.inline(n[0])}}escape(t){const n=this.rules.inline.escape.exec(t);if(n)return{type:"escape",raw:n[0],text:escape$1(n[1])}}tag(t){const n=this.rules.inline.tag.exec(t);if(n)return!this.lexer.state.inLink&&/^<a /i.test(n[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(n[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(n[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(n[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:n[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:n[0]}}link(t){const n=this.rules.inline.link.exec(t);if(n){const s=n[2].trim();if(!this.options.pedantic&&/^</.test(s)){if(!/>$/.test(s))return;const o=rtrim(s.slice(0,-1),"\\");if((s.length-o.length)%2===0)return}else{const o=findClosingBracket(n[2],"()");if(o>-1){const c=(n[0].indexOf("!")===0?5:4)+n[1].length+o;n[2]=n[2].substring(0,o),n[0]=n[0].substring(0,c).trim(),n[3]=""}}let r=n[2],l="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);o&&(r=o[1],l=o[3])}else l=n[3]?n[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(this.options.pedantic&&!/>$/.test(s)?r=r.slice(1):r=r.slice(1,-1)),outputLink(n,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:l&&l.replace(this.rules.inline.anyPunctuation,"$1")},n[0],this.lexer)}}reflink(t,n){let s;if((s=this.rules.inline.reflink.exec(t))||(s=this.rules.inline.nolink.exec(t))){const r=(s[2]||s[1]).replace(/\s+/g," "),l=n[r.toLowerCase()];if(!l){const o=s[0].charAt(0);return{type:"text",raw:o,text:o}}return outputLink(s,l,s[0],this.lexer)}}emStrong(t,n,s=""){let r=this.rules.inline.emStrongLDelim.exec(t);if(!r||r[3]&&s.match(/[\p{L}\p{N}]/u))return;if(!(r[1]||r[2]||"")||!s||this.rules.inline.punctuation.exec(s)){const o=[...r[0]].length-1;let a,c,h=o,u=0;const d=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,n=n.slice(-1*t.length+o);(r=d.exec(n))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(c=[...a].length,r[3]||r[4]){h+=c;continue}else if((r[5]||r[6])&&o%3&&!((o+c)%3)){u+=c;continue}if(h-=c,h>0)continue;c=Math.min(c,c+h+u);const p=[...r[0]][0].length,f=t.slice(0,o+r.index+p+c);if(Math.min(o,c)%2){const m=f.slice(1,-1);return{type:"em",raw:f,text:m,tokens:this.lexer.inlineTokens(m)}}const g=f.slice(2,-2);return{type:"strong",raw:f,text:g,tokens:this.lexer.inlineTokens(g)}}}}codespan(t){const n=this.rules.inline.code.exec(t);if(n){let s=n[2].replace(/\n/g," ");const r=/[^ ]/.test(s),l=/^ /.test(s)&&/ $/.test(s);return r&&l&&(s=s.substring(1,s.length-1)),s=escape$1(s,!0),{type:"codespan",raw:n[0],text:s}}}br(t){const n=this.rules.inline.br.exec(t);if(n)return{type:"br",raw:n[0]}}del(t){const n=this.rules.inline.del.exec(t);if(n)return{type:"del",raw:n[0],text:n[2],tokens:this.lexer.inlineTokens(n[2])}}autolink(t){const n=this.rules.inline.autolink.exec(t);if(n){let s,r;return n[2]==="@"?(s=escape$1(n[1]),r="mailto:"+s):(s=escape$1(n[1]),r=s),{type:"link",raw:n[0],text:s,href:r,tokens:[{type:"text",raw:s,text:s}]}}}url(t){let n;if(n=this.rules.inline.url.exec(t)){let s,r;if(n[2]==="@")s=escape$1(n[0]),r="mailto:"+s;else{let l;do l=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])?.[0]??"";while(l!==n[0]);s=escape$1(n[0]),n[1]==="www."?r="http://"+n[0]:r=n[0]}return{type:"link",raw:n[0],text:s,href:r,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(t){const n=this.rules.inline.text.exec(t);if(n){let s;return this.lexer.state.inRawBlock?s=n[0]:s=escape$1(n[0]),{type:"text",raw:n[0],text:s}}}}const newline=/^(?: *(?:\n|$))+/,blockCode=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,bullet=/(?:[*+-]|\d{1,9}[.)])/,lheading=edit(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,bullet).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),_paragraph=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,blockText=/^[^\n]+/,_blockLabel=/(?!\s*\])(?:\\.|[^\[\]\\])+/,def=edit(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",_blockLabel).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),list=edit(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,bullet).getRegex(),_tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",_comment=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,html=edit("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",_comment).replace("tag",_tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),paragraph=edit(_paragraph).replace("hr",hr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",_tag).getRegex(),blockquote=edit(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",paragraph).getRegex(),blockNormal={blockquote,code:blockCode,def,fences,heading,hr,html,lheading,list,newline,paragraph,table:noopTest,text:blockText},gfmTable=edit("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",hr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",_tag).getRegex(),blockGfm={...blockNormal,table:gfmTable,paragraph:edit(_paragraph).replace("hr",hr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",gfmTable).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",_tag).getRegex()},blockPedantic={...blockNormal,html:edit(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",_comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:noopTest,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:edit(_paragraph).replace("hr",hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",lheading).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},escape=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,inlineCode=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br=/^( {2,}|\\)\n(?!\s*$)/,inlineText=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,_punctuation="\\p{P}\\p{S}",punctuation=edit(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,_punctuation).getRegex(),blockSkip=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,emStrongLDelim=edit(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,_punctuation).getRegex(),emStrongRDelimAst=edit("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,_punctuation).getRegex(),emStrongRDelimUnd=edit("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,_punctuation).getRegex(),anyPunctuation=edit(/\\([punct])/,"gu").replace(/punct/g,_punctuation).getRegex(),autolink=edit(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),_inlineComment=edit(_comment).replace("(?:-->|$)","-->").getRegex(),tag=edit("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",_inlineComment).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),_inlineLabel=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,link=edit(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",_inlineLabel).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),reflink=edit(/^!?\[(label)\]\[(ref)\]/).replace("label",_inlineLabel).replace("ref",_blockLabel).getRegex(),nolink=edit(/^!?\[(ref)\](?:\[\])?/).replace("ref",_blockLabel).getRegex(),reflinkSearch=edit("reflink|nolink(?!\\()","g").replace("reflink",reflink).replace("nolink",nolink).getRegex(),inlineNormal={_backpedal:noopTest,anyPunctuation,autolink,blockSkip,br,code:inlineCode,del:noopTest,emStrongLDelim,emStrongRDelimAst,emStrongRDelimUnd,escape,link,nolink,punctuation,reflink,reflinkSearch,tag,text:inlineText,url:noopTest},inlinePedantic={...inlineNormal,link:edit(/^!?\[(label)\]\((.*?)\)/).replace("label",_inlineLabel).getRegex(),reflink:edit(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",_inlineLabel).getRegex()},inlineGfm={...inlineNormal,escape:edit(escape).replace("])","~|])").getRegex(),url:edit(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},inlineBreaks={...inlineGfm,br:edit(br).replace("{2,}","*").getRegex(),text:edit(inlineGfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},block={normal:blockNormal,gfm:blockGfm,pedantic:blockPedantic},inline={normal:inlineNormal,gfm:inlineGfm,breaks:inlineBreaks,pedantic:inlinePedantic};class _Lexer{tokens;options;state;tokenizer;inlineQueue;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||_defaults,this.options.tokenizer=this.options.tokenizer||new _Tokenizer,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={block:block.normal,inline:inline.normal};this.options.pedantic?(n.block=block.pedantic,n.inline=inline.pedantic):this.options.gfm&&(n.block=block.gfm,this.options.breaks?n.inline=inline.breaks:n.inline=inline.gfm),this.tokenizer.rules=n}static get rules(){return{block,inline}}static lex(t,n){return new _Lexer(n).lex(t)}static lexInline(t,n){return new _Lexer(n).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const s=this.inlineQueue[n];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],s=!1){this.options.pedantic?t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t=t.replace(/^( *)(\t+)/gm,(a,c,h)=>c+"    ".repeat(h.length));let r,l,o;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(r=a.call({lexer:this},t,n))?(t=t.substring(r.raw.length),n.push(r),!0):!1))){if(r=this.tokenizer.space(t)){t=t.substring(r.raw.length),r.raw.length===1&&n.length>0?n[n.length-1].raw+=`
`:n.push(r);continue}if(r=this.tokenizer.code(t)){t=t.substring(r.raw.length),l=n[n.length-1],l&&(l.type==="paragraph"||l.type==="text")?(l.raw+=`
`+r.raw,l.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=l.text):n.push(r);continue}if(r=this.tokenizer.fences(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.heading(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.hr(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.blockquote(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.list(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.html(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.def(t)){t=t.substring(r.raw.length),l=n[n.length-1],l&&(l.type==="paragraph"||l.type==="text")?(l.raw+=`
`+r.raw,l.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=l.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.lheading(t)){t=t.substring(r.raw.length),n.push(r);continue}if(o=t,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const c=t.slice(1);let h;this.options.extensions.startBlock.forEach(u=>{h=u.call({lexer:this},c),typeof h=="number"&&h>=0&&(a=Math.min(a,h))}),a<1/0&&a>=0&&(o=t.substring(0,a+1))}if(this.state.top&&(r=this.tokenizer.paragraph(o))){l=n[n.length-1],s&&l?.type==="paragraph"?(l.raw+=`
`+r.raw,l.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=l.text):n.push(r),s=o.length!==t.length,t=t.substring(r.raw.length);continue}if(r=this.tokenizer.text(t)){t=t.substring(r.raw.length),l=n[n.length-1],l&&l.type==="text"?(l.raw+=`
`+r.raw,l.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=l.text):n.push(r);continue}if(t){const a="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){let s,r,l,o=t,a,c,h;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;t;)if(c||(h=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(s=u.call({lexer:this},t,n))?(t=t.substring(s.raw.length),n.push(s),!0):!1))){if(s=this.tokenizer.escape(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.tag(t)){t=t.substring(s.raw.length),r=n[n.length-1],r&&s.type==="text"&&r.type==="text"?(r.raw+=s.raw,r.text+=s.text):n.push(s);continue}if(s=this.tokenizer.link(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(s.raw.length),r=n[n.length-1],r&&s.type==="text"&&r.type==="text"?(r.raw+=s.raw,r.text+=s.text):n.push(s);continue}if(s=this.tokenizer.emStrong(t,o,h)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.codespan(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.br(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.del(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.autolink(t)){t=t.substring(s.raw.length),n.push(s);continue}if(!this.state.inLink&&(s=this.tokenizer.url(t))){t=t.substring(s.raw.length),n.push(s);continue}if(l=t,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const d=t.slice(1);let p;this.options.extensions.startInline.forEach(f=>{p=f.call({lexer:this},d),typeof p=="number"&&p>=0&&(u=Math.min(u,p))}),u<1/0&&u>=0&&(l=t.substring(0,u+1))}if(s=this.tokenizer.inlineText(l)){t=t.substring(s.raw.length),s.raw.slice(-1)!=="_"&&(h=s.raw.slice(-1)),c=!0,r=n[n.length-1],r&&r.type==="text"?(r.raw+=s.raw,r.text+=s.text):n.push(s);continue}if(t){const u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return n}}class _Renderer{options;parser;constructor(t){this.options=t||_defaults}space(t){return""}code({text:t,lang:n,escaped:s}){const r=(n||"").match(/^\S*/)?.[0],l=t.replace(/\n$/,"")+`
`;return r?'<pre><code class="language-'+escape$1(r)+'">'+(s?l:escape$1(l,!0))+`</code></pre>
`:"<pre><code>"+(s?l:escape$1(l,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}heading({tokens:t,depth:n}){return`<h${n}>${this.parser.parseInline(t)}</h${n}>
`}hr(t){return`<hr>
`}list(t){const n=t.ordered,s=t.start;let r="";for(let a=0;a<t.items.length;a++){const c=t.items[a];r+=this.listitem(c)}const l=n?"ol":"ul",o=n&&s!==1?' start="'+s+'"':"";return"<"+l+o+`>
`+r+"</"+l+`>
`}listitem(t){let n="";if(t.task){const s=this.checkbox({checked:!!t.checked});t.loose?t.tokens.length>0&&t.tokens[0].type==="paragraph"?(t.tokens[0].text=s+" "+t.tokens[0].text,t.tokens[0].tokens&&t.tokens[0].tokens.length>0&&t.tokens[0].tokens[0].type==="text"&&(t.tokens[0].tokens[0].text=s+" "+t.tokens[0].tokens[0].text)):t.tokens.unshift({type:"text",raw:s+" ",text:s+" "}):n+=s+" "}return n+=this.parser.parse(t.tokens,!!t.loose),`<li>${n}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let n="",s="";for(let l=0;l<t.header.length;l++)s+=this.tablecell(t.header[l]);n+=this.tablerow({text:s});let r="";for(let l=0;l<t.rows.length;l++){const o=t.rows[l];s="";for(let a=0;a<o.length;a++)s+=this.tablecell(o[a]);r+=this.tablerow({text:s})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+n+`</thead>
`+r+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){const n=this.parser.parseInline(t.tokens),s=t.header?"th":"td";return(t.align?`<${s} align="${t.align}">`:`<${s}>`)+n+`</${s}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${t}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:n,tokens:s}){const r=this.parser.parseInline(s),l=cleanUrl(t);if(l===null)return r;t=l;let o='<a href="'+t+'"';return n&&(o+=' title="'+n+'"'),o+=">"+r+"</a>",o}image({href:t,title:n,text:s}){const r=cleanUrl(t);if(r===null)return s;t=r;let l=`<img src="${t}" alt="${s}"`;return n&&(l+=` title="${n}"`),l+=">",l}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):t.text}}class _TextRenderer{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}}class _Parser{options;renderer;textRenderer;constructor(t){this.options=t||_defaults,this.options.renderer=this.options.renderer||new _Renderer,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new _TextRenderer}static parse(t,n){return new _Parser(n).parse(t)}static parseInline(t,n){return new _Parser(n).parseInline(t)}parse(t,n=!0){let s="";for(let r=0;r<t.length;r++){const l=t[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[l.type]){const a=l,c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){s+=c||"";continue}}const o=l;switch(o.type){case"space":{s+=this.renderer.space(o);continue}case"hr":{s+=this.renderer.hr(o);continue}case"heading":{s+=this.renderer.heading(o);continue}case"code":{s+=this.renderer.code(o);continue}case"table":{s+=this.renderer.table(o);continue}case"blockquote":{s+=this.renderer.blockquote(o);continue}case"list":{s+=this.renderer.list(o);continue}case"html":{s+=this.renderer.html(o);continue}case"paragraph":{s+=this.renderer.paragraph(o);continue}case"text":{let a=o,c=this.renderer.text(a);for(;r+1<t.length&&t[r+1].type==="text";)a=t[++r],c+=`
`+this.renderer.text(a);n?s+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c}]}):s+=c;continue}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return s}parseInline(t,n){n=n||this.renderer;let s="";for(let r=0;r<t.length;r++){const l=t[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[l.type]){const a=this.options.extensions.renderers[l.type].call({parser:this},l);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(l.type)){s+=a||"";continue}}const o=l;switch(o.type){case"escape":{s+=n.text(o);break}case"html":{s+=n.html(o);break}case"link":{s+=n.link(o);break}case"image":{s+=n.image(o);break}case"strong":{s+=n.strong(o);break}case"em":{s+=n.em(o);break}case"codespan":{s+=n.codespan(o);break}case"br":{s+=n.br(o);break}case"del":{s+=n.del(o);break}case"text":{s+=n.text(o);break}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return s}}class _Hooks{options;constructor(t){this.options=t||_defaults}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}}class Marked{defaults=_getDefaults();options=this.setOptions;parse=this.#e(_Lexer.lex,_Parser.parse);parseInline=this.#e(_Lexer.lexInline,_Parser.parseInline);Parser=_Parser;Renderer=_Renderer;TextRenderer=_TextRenderer;Lexer=_Lexer;Tokenizer=_Tokenizer;Hooks=_Hooks;constructor(...t){this.use(...t)}walkTokens(t,n){let s=[];for(const r of t)switch(s=s.concat(n.call(this,r)),r.type){case"table":{const l=r;for(const o of l.header)s=s.concat(this.walkTokens(o.tokens,n));for(const o of l.rows)for(const a of o)s=s.concat(this.walkTokens(a.tokens,n));break}case"list":{const l=r;s=s.concat(this.walkTokens(l.items,n));break}default:{const l=r;this.defaults.extensions?.childTokens?.[l.type]?this.defaults.extensions.childTokens[l.type].forEach(o=>{const a=l[o].flat(1/0);s=s.concat(this.walkTokens(a,n))}):l.tokens&&(s=s.concat(this.walkTokens(l.tokens,n)))}}return s}use(...t){const n=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(s=>{const r={...s};if(r.async=this.defaults.async||r.async||!1,s.extensions&&(s.extensions.forEach(l=>{if(!l.name)throw new Error("extension name required");if("renderer"in l){const o=n.renderers[l.name];o?n.renderers[l.name]=function(...a){let c=l.renderer.apply(this,a);return c===!1&&(c=o.apply(this,a)),c}:n.renderers[l.name]=l.renderer}if("tokenizer"in l){if(!l.level||l.level!=="block"&&l.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=n[l.level];o?o.unshift(l.tokenizer):n[l.level]=[l.tokenizer],l.start&&(l.level==="block"?n.startBlock?n.startBlock.push(l.start):n.startBlock=[l.start]:l.level==="inline"&&(n.startInline?n.startInline.push(l.start):n.startInline=[l.start]))}"childTokens"in l&&l.childTokens&&(n.childTokens[l.name]=l.childTokens)}),r.extensions=n),s.renderer){const l=this.defaults.renderer||new _Renderer(this.defaults);for(const o in s.renderer){if(!(o in l))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;const a=o;let c=s.renderer[a];const h=l[a];l[a]=(...u)=>{s.useNewRenderer||(c=this.#t(c,a,l));let d=c.apply(l,u);return d===!1&&(d=h.apply(l,u)),d||""}}r.renderer=l}if(s.tokenizer){const l=this.defaults.tokenizer||new _Tokenizer(this.defaults);for(const o in s.tokenizer){if(!(o in l))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const a=o,c=s.tokenizer[a],h=l[a];l[a]=(...u)=>{let d=c.apply(l,u);return d===!1&&(d=h.apply(l,u)),d}}r.tokenizer=l}if(s.hooks){const l=this.defaults.hooks||new _Hooks;for(const o in s.hooks){if(!(o in l))throw new Error(`hook '${o}' does not exist`);if(o==="options")continue;const a=o,c=s.hooks[a],h=l[a];_Hooks.passThroughHooks.has(o)?l[a]=u=>{if(this.defaults.async)return Promise.resolve(c.call(l,u)).then(p=>h.call(l,p));const d=c.call(l,u);return h.call(l,d)}:l[a]=(...u)=>{let d=c.apply(l,u);return d===!1&&(d=h.apply(l,u)),d}}r.hooks=l}if(s.walkTokens){const l=this.defaults.walkTokens,o=s.walkTokens;r.walkTokens=function(a){let c=[];return c.push(o.call(this,a)),l&&(c=c.concat(l.call(this,a))),c}}this.defaults={...this.defaults,...r}}),this}#t(t,n,s){switch(n){case"heading":return function(r){return!r.type||r.type!==n?t.apply(this,arguments):t(s.parser.parseInline(r.tokens),r.depth,unescape(s.parser.parseInline(r.tokens,s.parser.textRenderer)))};case"code":return function(r){return!r.type||r.type!==n?t.apply(this,arguments):t(r.text,r.lang,!!r.escaped)};case"table":return function(r){if(!r.type||r.type!==n)return t.apply(this,arguments);let l="",o="";for(let c=0;c<r.header.length;c++)o+=this.tablecell({text:r.header[c].text,tokens:r.header[c].tokens,header:!0,align:r.align[c]});l+=this.tablerow({text:o});let a="";for(let c=0;c<r.rows.length;c++){const h=r.rows[c];o="";for(let u=0;u<h.length;u++)o+=this.tablecell({text:h[u].text,tokens:h[u].tokens,header:!1,align:r.align[u]});a+=this.tablerow({text:o})}return t(l,a)};case"blockquote":return function(r){if(!r.type||r.type!==n)return t.apply(this,arguments);const l=this.parser.parse(r.tokens);return t(l)};case"list":return function(r){if(!r.type||r.type!==n)return t.apply(this,arguments);const l=r.ordered,o=r.start,a=r.loose;let c="";for(let h=0;h<r.items.length;h++){const u=r.items[h],d=u.checked,p=u.task;let f="";if(u.task){const g=this.checkbox({checked:!!d});a?u.tokens.length>0&&u.tokens[0].type==="paragraph"?(u.tokens[0].text=g+" "+u.tokens[0].text,u.tokens[0].tokens&&u.tokens[0].tokens.length>0&&u.tokens[0].tokens[0].type==="text"&&(u.tokens[0].tokens[0].text=g+" "+u.tokens[0].tokens[0].text)):u.tokens.unshift({type:"text",text:g+" "}):f+=g+" "}f+=this.parser.parse(u.tokens,a),c+=this.listitem({type:"list_item",raw:f,text:f,task:p,checked:!!d,loose:a,tokens:u.tokens})}return t(c,l,o)};case"html":return function(r){return!r.type||r.type!==n?t.apply(this,arguments):t(r.text,r.block)};case"paragraph":return function(r){return!r.type||r.type!==n?t.apply(this,arguments):t(this.parser.parseInline(r.tokens))};case"escape":return function(r){return!r.type||r.type!==n?t.apply(this,arguments):t(r.text)};case"link":return function(r){return!r.type||r.type!==n?t.apply(this,arguments):t(r.href,r.title,this.parser.parseInline(r.tokens))};case"image":return function(r){return!r.type||r.type!==n?t.apply(this,arguments):t(r.href,r.title,r.text)};case"strong":return function(r){return!r.type||r.type!==n?t.apply(this,arguments):t(this.parser.parseInline(r.tokens))};case"em":return function(r){return!r.type||r.type!==n?t.apply(this,arguments):t(this.parser.parseInline(r.tokens))};case"codespan":return function(r){return!r.type||r.type!==n?t.apply(this,arguments):t(r.text)};case"del":return function(r){return!r.type||r.type!==n?t.apply(this,arguments):t(this.parser.parseInline(r.tokens))};case"text":return function(r){return!r.type||r.type!==n?t.apply(this,arguments):t(r.text)}}return t}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,n){return _Lexer.lex(t,n??this.defaults)}parser(t,n){return _Parser.parse(t,n??this.defaults)}#e(t,n){return(s,r)=>{const l={...r},o={...this.defaults,...l};this.defaults.async===!0&&l.async===!1&&(o.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),o.async=!0);const a=this.#n(!!o.silent,!!o.async);if(typeof s>"u"||s===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof s!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(s)+", string expected"));if(o.hooks&&(o.hooks.options=o),o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(s):s).then(c=>t(c,o)).then(c=>o.hooks?o.hooks.processAllTokens(c):c).then(c=>o.walkTokens?Promise.all(this.walkTokens(c,o.walkTokens)).then(()=>c):c).then(c=>n(c,o)).then(c=>o.hooks?o.hooks.postprocess(c):c).catch(a);try{o.hooks&&(s=o.hooks.preprocess(s));let c=t(s,o);o.hooks&&(c=o.hooks.processAllTokens(c)),o.walkTokens&&this.walkTokens(c,o.walkTokens);let h=n(c,o);return o.hooks&&(h=o.hooks.postprocess(h)),h}catch(c){return a(c)}}}#n(t,n){return s=>{if(s.message+=`
Please report this to https://github.com/markedjs/marked.`,t){const r="<p>An error occurred:</p><pre>"+escape$1(s.message+"",!0)+"</pre>";return n?Promise.resolve(r):r}if(n)return Promise.reject(s);throw s}}}const markedInstance=new Marked;function marked(i,t){return markedInstance.parse(i,t)}marked.options=marked.setOptions=function(i){return markedInstance.setOptions(i),marked.defaults=markedInstance.defaults,changeDefaults(marked.defaults),marked};marked.getDefaults=_getDefaults;marked.defaults=_defaults;marked.use=function(...i){return markedInstance.use(...i),marked.defaults=markedInstance.defaults,changeDefaults(marked.defaults),marked};marked.walkTokens=function(i,t){return markedInstance.walkTokens(i,t)};marked.parseInline=markedInstance.parseInline;marked.Parser=_Parser;marked.parser=_Parser.parse;marked.Renderer=_Renderer;marked.TextRenderer=_TextRenderer;marked.Lexer=_Lexer;marked.lexer=_Lexer.lex;marked.Tokenizer=_Tokenizer;marked.Hooks=_Hooks;marked.parse=marked;marked.options;marked.setOptions;marked.use;marked.walkTokens;marked.parseInline;_Parser.parse;_Lexer.lex;function classes(...i){return i.filter(t=>t).join(" ")}const AutoTextarea$1="_AutoTextarea_9px1d_1",styles$f={AutoTextarea:AutoTextarea$1};var _tmpl$$o=template("<textarea>");const GAP$1=0,AutoTextarea=i=>{const[t,n]=createSignal(null),s=(()=>{var r=_tmpl$$o();return r.$$input=l=>{i.onChange(l.currentTarget.value),n(l.currentTarget.scrollHeight)},r.style.setProperty("padding","0px"),r.style.setProperty("flex-grow","2"),createRenderEffect(l=>{var o=classes(i.class,styles$f.AutoTextarea),a=t()?`${t()-GAP$1*2}px`:"";return o!==l.e&&className(r,l.e=o),a!==l.t&&((l.t=a)!=null?r.style.setProperty("height",a):r.style.removeProperty("height")),l},{e:void 0,t:void 0}),createRenderEffect(()=>r.value=i.value),r})();return createEffect(()=>{n(s.scrollHeight)}),s};delegateEvents(["input"]);const content="_content_11rst_1",preview="_preview_11rst_7",textarea="_textarea_11rst_12",css$1={content,preview,textarea},button="_button_1qxlr_1",buttonS="_buttonS_1qxlr_12",styles$e={button,buttonS};var _tmpl$$n=template("<button>");const Button=i=>(()=>{var t=_tmpl$$n();return addEventListener(t,"click",i.onClick,!0),insert(t,()=>i.children),createRenderEffect(()=>className(t,classes(styles$e.button,i.size==="s"&&styles$e.buttonS))),t})();delegateEvents(["click"]);const container$3="_container_jcv5u_1",styles$d={container:container$3};var _tmpl$$m=template("<div>");const HStack=i=>(()=>{var t=_tmpl$$m();return insert(t,()=>i.children),createRenderEffect(n=>{var s=styles$d.container,r=`${i.gap||8}px`,l=i.justifyContent?"flex-end":void 0,o=i.alignItems?"flex-start":"center";return s!==n.e&&className(t,n.e=s),r!==n.t&&((n.t=r)!=null?t.style.setProperty("gap",r):t.style.removeProperty("gap")),l!==n.a&&((n.a=l)!=null?t.style.setProperty("justify-content",l):t.style.removeProperty("justify-content")),o!==n.o&&((n.o=o)!=null?t.style.setProperty("align-items",o):t.style.removeProperty("align-items")),n},{e:void 0,t:void 0,a:void 0,o:void 0}),t})(),container$2="_container_p579p_1",styles$c={container:container$2};var _tmpl$$l=template("<div>");const VStack=i=>(()=>{var t=_tmpl$$l();return insert(t,()=>i.children),createRenderEffect(n=>{var s=styles$c.container,r=`${i.gap||8}px`;return s!==n.e&&className(t,n.e=s),r!==n.t&&((n.t=r)!=null?t.style.setProperty("gap",r):t.style.removeProperty("gap")),n},{e:void 0,t:void 0}),t})();var _tmpl$$k=template("<div><div>"),_tmpl$2$6=template("<div>");const RichEdit=i=>{const[t,n]=createSignal(!1),[s,r]=createSignal(i.value);return createEffect(()=>{const l=i.resetKey;return r(i.value),n(!1),l}),(()=>{var l=_tmpl$2$6();return insert(l,createComponent(Show,{get when(){return!t()},get children(){return createComponent(HStack,{justifyContent:"end",get children(){return createComponent(Button,{size:"s",onClick:()=>{n(!0)},get children(){return i.editLabel??"Edit"}})}})}}),null),insert(l,createComponent(VStack,{get children(){return[createComponent(Show,{get when(){return t()},get children(){return createComponent(HStack,{get children(){return[createComponent(Button,{size:"s",onClick:()=>{n(!1),r(i.value)},children:"Cancel"}),createComponent(Button,{size:"s",onClick:()=>{n(!1),i.onChange(s())},children:"Save"})]}})}}),createComponent(Show,{get when(){return t()},get children(){return createComponent(AutoTextarea,{get class(){return css$1.textarea},get value(){return s()},onChange:o=>{r(o)}})}}),(()=>{var o=_tmpl$$k(),a=o.firstChild;return createRenderEffect(c=>{var h=css$1.content,u=marked(s()),d=css$1.preview;return h!==c.e&&className(o,c.e=h),u!==c.t&&(a.innerHTML=c.t=u),d!==c.a&&className(a,c.a=d),c},{e:void 0,t:void 0,a:void 0}),o})()]}}),null),l})()},taskListItem="_taskListItem_1hg06_1",taskListDrag="_taskListDrag_1hg06_5",styles$b={taskListItem,taskListDrag};var _tmpl$$j=template("<div>");const renderer={link:function(i,t,n){return'<a target="_blank" href="'+i+'" title="'+t+'">'+(n??i)+"</a>"}};marked.use({renderer});const MarkdownPreview=i=>(()=>{var t=_tmpl$$j();return createRenderEffect(()=>t.innerHTML=marked(i.value)),t})(),checkbox$1="_checkbox_1bra6_1",styles$a={checkbox:checkbox$1};var _tmpl$$i=template("<input type=checkbox>");const Checkbox=i=>(()=>{var t=_tmpl$$i();return t.addEventListener("change",n=>i.onChange(n.currentTarget.checked)),createRenderEffect(()=>className(t,styles$a.checkbox)),createRenderEffect(()=>t.checked=i.value),t})();var _tmpl$$h=template("<a href=#>"),_tmpl$2$5=template("<div>");const TaskListItem=i=>{const t=useStore(),n=useUIState(),s=createMemo(()=>t.getTask(i.id)());return(()=>{var r=_tmpl$2$5();return r.addEventListener("dragover",l=>(l.preventDefault(),!1)),r.addEventListener("drop",l=>{const o=l.dataTransfer;if(!o)return;const a=o.getData("application/json"),c=JSON.parse(a);c.type==="task"&&(t.link(c.id,i.parentId,i.id),l.stopPropagation())}),insert(r,createComponent(HStack,{get children(){return[createComponent(Checkbox,{get value(){return s().isDone},onChange:l=>t.setDone(i.id,l)}),(()=>{var l=_tmpl$$h();return l.addEventListener("dragstart",o=>{const a=o.dataTransfer;a&&(a.effectAllowed="move",a.setData("application/json",JSON.stringify({type:"task",id:i.id})))}),l.$$click=o=>{o.preventDefault(),n.setOpenedTask(i.id)},insert(l,(()=>{var o=createMemo(()=>s().title==="");return()=>o()?"Empty":s().title})()),l})()," ",createComponent(Button,{size:"s",onClick:()=>{t.unlink(i.id,i.parentId)},children:"X"})]}}),null),insert(r,createComponent(Show,{get when(){return s().result!==""},get children(){return createComponent(MarkdownPreview,{get value(){return s().result}})}}),null),createRenderEffect(()=>className(r,styles$b.taskListItem)),r})()};delegateEvents(["click"]);var _tmpl$$g=template("<div>");const TaskList=i=>{const t=useStore(),n=createMemo(()=>t.getChildren(i.parentId)());return(()=>{var s=_tmpl$$g();return insert(s,createComponent(For,{get each(){return n()},children:r=>(()=>{var l=_tmpl$$g();return insert(l,()=>createComponent(TaskListItem,{id:r,get parentId(){return i.parentId}})),l})()})),s})()},Input$1="_Input_15un8_1",styles$9={Input:Input$1};var _tmpl$$f=template("<input>");const Input=i=>(()=>{var t=_tmpl$$f();return addEventListener(t,"input",i.onInput,!0),addEventListener(t,"keypress",i.onKeyPress),createRenderEffect(n=>{var s=classes(styles$9.Input,i.class),r=i.placeholder;return s!==n.e&&className(t,n.e=s),r!==n.t&&setAttribute(t,"placeholder",n.t=r),n},{e:void 0,t:void 0}),createRenderEffect(()=>t.value=i.value),t})();delegateEvents(["input"]);const input$1="_input_1fam9_1",styles$8={input:input$1};var _tmpl$$e=template("<div>");const CreateTask=i=>{const[t,n]=createSignal(""),s=useStore();return(()=>{var r=_tmpl$$e();return r.style.setProperty("position","relative"),insert(r,createComponent(Input,{get class(){return styles$8.input},onInput:l=>{n(l.currentTarget.value)},get value(){return t()},placeholder:"Type task name and press Enter",onKeyPress:l=>{l.key==="Enter"&&(s.createTask(i.parentId,{title:t(),description:"",result:"",isPriorityList:!1}),n(""))}})),r})()},container$1="_container_3nk25_1",input="_input_3nk25_7",styles$7={container:container$1,input};var _tmpl$$d=template("<span>");const TitleEditable=i=>{const t=useStore(),n=createMemo(()=>t.getTask(i.id)().title),[s,r]=createSignal(n()),[l,o]=createSignal(!1);return createEffect(()=>{i.id&&(o(!1),r(n()))}),(()=>{var a=_tmpl$$d();return insert(a,createComponent(Input,{get class(){return styles$7.input},get value(){return s()},onInput:c=>{o(!0),r(c.currentTarget.value)},onKeyPress:c=>{c.code==="Enter"&&(o(!1),t.setTitle(i.id,s()))}}),null),insert(a,createComponent(Show,{get when(){return l()},get children(){return[createComponent(Button,{onClick:c=>{o(!1),t.setTitle(i.id,s())},children:"Save"}),createComponent(Button,{onClick:c=>{o(!1),r(n())},children:"Undo"})]}}),null),createRenderEffect(()=>className(a,styles$7.container)),a})()},PostponeCountdown$1="_PostponeCountdown_1f5r7_1",styles$6={PostponeCountdown:PostponeCountdown$1};var _tmpl$$c=template("<div> to unblock");function calcLeft(i){return Math.floor((i.valueOf()-new Date().valueOf())/1e3)}function humanizeLeft(i){if(i<60)return`${i}s`;if(i<60*60)return`${Math.floor(i/60)}m`;if(i<60*60*24)return`${Math.floor(i/60/60)}h`}const PostponeCountdown=i=>{const[t,n]=createSignal(calcLeft(i.until)),s=setInterval(()=>{n(calcLeft(i.until))},1e3);return onCleanup(()=>{clearInterval(s)}),createComponent(Show,{get when(){return t()>0},get children(){var r=_tmpl$$c(),l=r.firstChild;return insert(r,()=>humanizeLeft(t()),l),createRenderEffect(()=>className(r,styles$6.PostponeCountdown)),r}})},label="_label_h5qxu_1",styles$5={label};var _tmpl$$b=template("<label>");const CheckboxLabel=i=>(()=>{var t=_tmpl$$b();return insert(t,()=>i.children),createRenderEffect(()=>className(t,styles$5.label)),t})(),checkbox="_checkbox_4ndnj_1",styles$4={checkbox};var _tmpl$$a=template("<input type=checkbox>");const Chevron=i=>(()=>{var t=_tmpl$$a();return t.addEventListener("change",n=>i.onChange(n.currentTarget.checked)),createRenderEffect(()=>className(t,styles$4.checkbox)),createRenderEffect(()=>t.checked=i.value),t})(),text="_text_1vdid_1",dim="_dim_1vdid_5",styles$3={text,dim};var _tmpl$$9=template("<span>");const Text=i=>(()=>{var t=_tmpl$$9();return insert(t,()=>i.children),createRenderEffect(()=>className(t,classes(styles$3.text,i.variant=="dim"&&styles$3.dim))),t})();var _tmpl$$8=template("<div>");const Collapse=i=>{const[t,n]=createSignal(!1);return(()=>{var s=_tmpl$$8();return insert(s,createComponent(VStack,{gap:16,get children(){return[createComponent(CheckboxLabel,{get children(){return[createComponent(Chevron,{get value(){return t()},onChange:r=>n(r)}),createComponent(Text,{variant:"dim",get children(){return i.title}})]}}),createComponent(Show,{get when(){return t()},get children(){return i.children}})]}})),s})()};var _tmpl$$7=template("<div>"),_tmpl$2$4=template("<span><a href=#></a> <!> ");const ParentList=i=>{const t=useStore(),n=useUIState(),s=createMemo(()=>t.getParents(i.id)());return(()=>{var r=_tmpl$$7();return insert(r,createComponent(Text,{variant:"dim",children:"Parents: "}),null),insert(r,createComponent(For,{get each(){return s()},children:l=>{const o=t.getTask(l);return(()=>{var a=_tmpl$2$4(),c=a.firstChild,h=c.nextSibling,u=h.nextSibling;return u.nextSibling,c.$$click=()=>{n.setOpenedTask(l)},insert(c,()=>o().title),insert(a,createComponent(Button,{size:"s",onClick:()=>{t.unlink(i.id,o().id)},children:"X"}),u),createRenderEffect(()=>(o().isDone?"line-through":void 0)!=null?c.style.setProperty("text-decoration",o().isDone?"line-through":void 0):c.style.removeProperty("text-decoration")),a})()}}),null),r})()};delegateEvents(["click"]);var _tmpl$$6=template("<div>"),_tmpl$2$3=template("<div>Postpone");const TaskFull=i=>{const t=useStore(),n=useUIState(),s=createMemo(()=>t.getTask(i.id)()),r=l=>{l.code==="Escape"&&n.setOpenedTask(null)};return document.addEventListener("keydown",r),onCleanup(()=>{document.removeEventListener("keydown",r)}),(()=>{var l=_tmpl$$6();return insert(l,createComponent(VStack,{gap:16,get children(){return[createComponent(ParentList,{get id(){return i.id}}),createComponent(HStack,{get children(){return[createComponent(Checkbox,{get value(){return s().isDone},onChange:o=>t.setDone(i.id,o)}),createComponent(TitleEditable,{get id(){return i.id}}),createComponent(Button,{onClick:o=>{n.setOpenedTask(null)},children:"close"})]}}),createComponent(RichEdit,{editLabel:"Edit description",get value(){return s().description},onChange:o=>{t.setDescription(i.id,o)}}),createComponent(TaskList,{get parentId(){return i.id}}),(()=>{var o=_tmpl$$6();return o.addEventListener("dragover",a=>(a.preventDefault(),!1)),o.addEventListener("drop",a=>{const c=a.dataTransfer;if(!c)return;const h=JSON.parse(c.getData("application/json"));h.type==="task"&&t.link(h.id,i.id)}),insert(o,createComponent(CreateTask,{get parentId(){return i.id}})),o})(),(()=>{var o=_tmpl$$6();return insert(o,createComponent(RichEdit,{get value(){return s().result},onChange:a=>{t.setResult(i.id,a)},editLabel:"Add/Edit result"})),o})(),(()=>{var o=_tmpl$$6();return o.style.setProperty("height","16px"),o})(),createComponent(Collapse,{title:"More options",get children(){return[createComponent(CheckboxLabel,{get children(){return[createComponent(Checkbox,{get value(){return s().isPriorityList},onChange:o=>t.setIsPriorityList(i.id,o)}),"Priority list"]}}),createComponent(HStack,{get children(){return[_tmpl$2$3(),createComponent(Button,{size:"s",onClick:()=>{t.postpone(i.id,new Date(new Date().valueOf()+1e3*60*5))},children:"5m"}),createComponent(Button,{size:"s",onClick:()=>{t.postpone(i.id,new Date(new Date().valueOf()+1e3*60*10))},children:"10m"}),createComponent(Button,{size:"s",onClick:()=>{t.postpone(i.id,new Date(new Date().valueOf()+1e3*60*30))},children:"30m"}),createComponent(Button,{size:"s",onClick:()=>{t.postpone(i.id,new Date(new Date().valueOf()+1e3*60*60))},children:"1h"}),createComponent(Button,{size:"s",onClick:()=>{t.postpone(i.id,new Date(new Date().valueOf()+1e3*60*60*2))},children:"2h"}),createComponent(Button,{size:"s",onClick:()=>{t.postpone(i.id,new Date(new Date().valueOf()+1e3*60*60*4))},children:"4h"}),createComponent(Button,{size:"s",onClick:()=>{t.postpone(i.id,new Date(new Date().valueOf()+1e3*60*60*24))},children:"day"}),createComponent(Show,{get when(){return s().postponedUntil},get children(){return[createComponent(Button,{size:"s",onClick:()=>{t.postpone(i.id,null)},children:"reset"}),createComponent(PostponeCountdown,{get until(){return s().postponedUntil}})]}})]}}),(()=>{var o=_tmpl$$6();return insert(o,createComponent(Button,{size:"s",onClick:()=>{n.setGoalTask(i.id)},children:"Set as goal"})),o})()]}})]}})),createRenderEffect(()=>className(l,styles$g.cont)),l})()};function getRelationsMappings$1(i){const t={},n={};for(let s=0;s<i.length;s++){const r=i[s];t[r.taskId]||(t[r.taskId]=[]),n[r.dependsOnId]||(n[r.dependsOnId]=[]),t[r.taskId].push(r.dependsOnId),n[r.dependsOnId].push(r.taskId)}return{children:t,parents:n}}function serializeRelation(i){return`${i.taskId}:${i.dependsOnId}`}function removeRedundantRelations(i,t){const n=getRelationsMappings$1(t),s={};for(let h=0;h<t.length;h++){const u=t[h];s[serializeRelation(u)]=!0}const r={},o=[{id:i,children:(n.children[i]||[]).slice()}];for(;o.length;){const h=o.pop();for(let u=0;u<o.length-1;u++){const d=serializeRelation({taskId:o[u].id,dependsOnId:h.id});s[d]&&(r[d]=!0)}if(h.children.length){const u=h.children.shift();o.push(h),o.push({id:u,children:(n.children[u]||[]).slice()})}}const a=[],c=[];for(let h=0;h<t.length;h++){const u=t[h];r[serializeRelation(u)]?c.push(u):a.push(u)}return{filtered:a,removed:c}}function getRelationsMappings(i){const t={},n={};for(let s=0;s<i.length;s++){const r=i[s];t[r.taskId]||(t[r.taskId]=[]),n[r.dependsOnId]||(n[r.dependsOnId]=[]),t[r.taskId].push(r.dependsOnId),n[r.dependsOnId].push(r.taskId)}return{children:t,parents:n}}function getMaxPaths(i,t){const n=[i],s={[i]:0};for(;n.length>0;){const r=n.shift(),l=s[r],o=t.children[r]||[];for(let a=0;a<o.length;a++){const c=o[a];s[c]=l+1,n.push(c)}}return s}function getShortestPathsTree(i,t){const n={},s=[i],r={[i]:!0};for(;s.length>0;){const l=s.shift(),o=t.children[l]||[];n[l]=[];for(let a=0;a<o.length;a++){const c=o[a];r[c]||(n[l].push(c),s.push(c),r[c]=!0)}}return n}function calcBreadthPosition(i,t){const n={},s=[i];let r=0;for(;s.length;){const l=s.pop(),o=t[l]||[];if(!o.length){n[l]=r,r++;continue}for(let a=o.length-1;a>=0;a--){const c=o[a];s.push(c)}}for(s.push(i);s.length;){const l=s.pop(),o=t[l]||[];let a=!0,c=-1/0,h=1/0;for(let u=0;u<o.length;u++){const d=o[u];if(n[d]===void 0){a=!1;break}else c=Math.max(n[d],c),h=Math.min(n[d],h)}if(a){n[l]=(h+c)/2;continue}s.push(l);for(let u=0;u<o.length;u++)n[o[u]]===void 0&&s.push(o[u])}return n}function isRedundant(i,t){return!!(i[t.taskId]&&i[t.taskId][t.dependsOnId])}function shiftPositionsToBottom(i,t,n,s){let r=[],l=0;const o=Object.keys(t);for(let u=0;u<o.length;u++){const d=parseInt(o[u],10),p=n.children[d];(!p||p.length===0)&&(r.push(d),l=Math.max(l,t[d]))}let a=r.map(u=>({id:u,level:s.includes(u)?l:l-1})),c={},h=!1;for(;a.length;){const u=a.shift();if(!u)break;const d=Math.min(c[u.id]??l,u.level);d<0&&(h=!0),c[u.id]=d;const p=n.parents[u.id]||[];for(let f=0;f<p.length;f++){const g=p[f];a.push({id:g,level:u.level-1})}}if(h){const u=Object.keys(c).map(d=>parseInt(d,10));for(let d=0;d<u.length;d++){const p=u[d];c[p]=c[p]+1}}return c}function calcTreePositions(i,t,n){const s=n.shiftDepths,r=n.flipDepth,l=removeRedundantRelations(i,t),o=getRelationsMappings(l.filtered),a={};for(let k=0;k<l.removed.length;k++){const y=l.removed[k];a[y.taskId]=a[y.taskId]||{},a[y.taskId][y.dependsOnId]=!0}let c=getMaxPaths(i,o);s&&(c=shiftPositionsToBottom(i,c,o,n.unlocked));const h=getShortestPathsTree(i,o),u=calcBreadthPosition(i,h),d={},p=[],f=[i];let g=0,m=0;for(;f.length;){const k=f.shift();p.push(k);const y=c[k]*200+20,x=u[k]*50+20;g=Math.max(x,g),m=Math.max(y,m),d[k]={x:y,y:x},h[k].forEach(b=>{f.push(b)})}if(r){const k=Object.keys(d);for(let y=0;y<k.length;y++){const x=k[y],b=d[x];d[x]={...b,x:m-b.x}}}return{elementsList:p,positions:d,redundantHash:a,maxY:g+100,maxX:m+200}}const container="_container_oxf9r_1",css={container},selected="_selected_iqema_1",TaskBoardContainer="_TaskBoardContainer_iqema_8",styles$2={selected,TaskBoardContainer};var _tmpl$$5=template("<div><a href=#>");const TaskBoardItem=i=>{const t=useStore(),n=useUIState(),s=createMemo(()=>t.getTask(i.id)());return(()=>{var r=_tmpl$$5(),l=r.firstChild;return l.addEventListener("dragover",o=>(o.preventDefault(),!1)),l.addEventListener("drop",o=>{const a=o.dataTransfer;if(!a)return;const c=a.getData("application/json"),h=JSON.parse(c);h.type==="task"&&(t.link(h.id,i.id),o.stopPropagation())}),l.addEventListener("dragstart",o=>{const a=o.dataTransfer;a&&(a.effectAllowed="move",a.setData("application/json",JSON.stringify({type:"task",id:i.id})))}),l.$$click=o=>{o.preventDefault(),n.setOpenedTask(i.id)},insert(l,()=>s().title),insert(r,createComponent(Show,{get when(){return s().postponedUntil},get children(){return createComponent(PostponeCountdown,{get until(){return s().postponedUntil}})}}),null),createRenderEffect(o=>{var a=`${i.left}px`,c=`${i.top}px`,h=styles$2.TaskBoardContainer,u=s().isDone?"line-through":"",d=s().id===n.openedTask()?styles$2.selected:void 0;return a!==o.e&&((o.e=a)!=null?r.style.setProperty("left",a):r.style.removeProperty("left")),c!==o.t&&((o.t=c)!=null?r.style.setProperty("top",c):r.style.removeProperty("top")),h!==o.a&&className(r,o.a=h),u!==o.o&&((o.o=u)!=null?l.style.setProperty("text-decoration",u):l.style.removeProperty("text-decoration")),d!==o.i&&className(l,o.i=d),o},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),r})()};delegateEvents(["click"]);var _tmpl$$4=template("<div class=Spline__remove>✕"),_tmpl$2$2=template("<div class=Spline><svg stroke=#777 stroke-width=1><path fill=transparent>");function minLeft(i,t){return Math.min(i.x,t.x)}function minTop(i,t){return Math.min(i.y,t.y)}const GAP=20;function movePointX(i,t){return{x:i.x+t,y:i.y}}function getPath(i){const t=movePointX(i.from,i.before),n=movePointX(i.to,-i.after),s=GAP,r=s+i.before,l=GAP,o=Math.abs((t.x-n.x)/2)+GAP+i.before,c=Math.abs(t.x-n.x)+GAP+i.before,h=Math.abs(t.y-n.y)+GAP;return t.y<n.y?`M${s},${l} L${r},${l} C${o},${l} ${o},${h} ${c},${h} L${c+i.after},${h}`:`M${s},${h} L${r},${h} C${o},${h} ${o},${l} ${c},${l} L${c+i.after},${l}`}const Spline=i=>{const t=createMemo(()=>i.from.x<i.to.x?{after:i.muted?0:i.to.x-i.from.x-200,before:0,from:i.from,to:i.to}:{before:i.muted?0:i.from.x-i.to.x-200,after:0,to:i.from,from:i.to});return(()=>{var n=_tmpl$2$2(),s=n.firstChild,r=s.firstChild;return insert(n,createComponent(Show,{get when(){return i.removeVisible},get children(){var l=_tmpl$$4();return addEventListener(l,"click",i.onRemoveClick,!0),createRenderEffect(o=>{var a=GAP+Math.max(t().to.x-t().from.x,0)-4+"px",c=GAP+Math.abs(t().from.y-t().to.y)-8+"px";return a!==o.e&&((o.e=a)!=null?l.style.setProperty("left",a):l.style.removeProperty("left")),c!==o.t&&((o.t=c)!=null?l.style.setProperty("top",c):l.style.removeProperty("top")),o},{e:void 0,t:void 0}),l}}),null),createRenderEffect(l=>{var o=minTop(t().from,t().to)-GAP+"px",a=minLeft(t().from,t().to)-GAP+"px",c=Math.abs(t().from.x-t().to.x)+2*GAP,h=Math.abs(t().from.y-t().to.y)+2*GAP,u=i.muted?"30%":"60%",d=classes(i.removeVisible&&"Spline__path_highlighted"),p=getPath(t());return o!==l.e&&((l.e=o)!=null?n.style.setProperty("top",o):n.style.removeProperty("top")),a!==l.t&&((l.t=a)!=null?n.style.setProperty("left",a):n.style.removeProperty("left")),c!==l.a&&setAttribute(s,"width",l.a=c),h!==l.o&&setAttribute(s,"height",l.o=h),u!==l.i&&setAttribute(s,"opacity",l.i=u),d!==l.n&&setAttribute(s,"class",l.n=d),p!==l.s&&setAttribute(r,"d",l.s=p),l},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),n})()};delegateEvents(["click"]);var _tmpl$$3=template("<a href=#>"),_tmpl$2$1=template("<div><div></div><div>");const Board=i=>{const t=useStore(),n=useUIState(),s=createMemo(()=>t.getTree(i.id,n.showCompleted(),n.hideBlockedSubTree())()),r=createMemo(()=>calcTreePositions(i.id,s().relations,{shiftDepths:n.shift(),flipDepth:n.flipHorizontally(),unlocked:s().unlocked}));return(()=>{var l=_tmpl$2$1(),o=l.firstChild,a=o.nextSibling;return o.style.setProperty("min-height","28px"),insert(o,createComponent(HStack,{alignItems:"start",get children(){return createComponent(Show,{get when(){return createMemo(()=>n.goalTask()!=null)()&&t.getTask(n.goalTask())()},get children(){return createComponent(HStack,{get children(){return["Goal:",(()=>{var c=_tmpl$$3();return c.$$click=h=>{h.preventDefault(),n.setOpenedTask(i.id)},insert(c,()=>t.getTask(n.goalTask())().title),c})(),createComponent(Button,{size:"s",onClick:c=>{c.preventDefault(),n.setGoalTask(null)},children:"Remove"})]}})}})}})),a.style.setProperty("position","relative"),insert(a,createComponent(For,{get each(){return s().relations},children:c=>createComponent(Spline,{get from(){return r().positions[c.taskId]},get to(){return r().positions[c.dependsOnId]},onRemoveClick:()=>{},removeVisible:!1,get muted(){return isRedundant(r().redundantHash,c)}})}),null),insert(a,createComponent(For,{get each(){return r().elementsList},children:(c,h)=>(r().positions[c],createComponent(TaskBoardItem,{id:c,get left(){return r().positions[c].x},get top(){return r().positions[c].y}}))}),null),createRenderEffect(c=>{var h=css.container,u=`${r().maxY}px`,d=`${r().maxX}px`;return h!==c.e&&className(l,c.e=h),u!==c.t&&((c.t=u)!=null?a.style.setProperty("height",u):a.style.removeProperty("height")),d!==c.a&&((c.a=d)!=null?a.style.setProperty("width",d):a.style.removeProperty("width")),c},{e:void 0,t:void 0,a:void 0}),l})()};delegateEvents(["click"]);const cont="_cont_17ps3_1",controls="_controls_17ps3_7",styles$1={cont,controls},modal="_modal_1fne3_1",styles={modal};var _tmpl$$2=template("<div>");const Modal=i=>(()=>{var t=_tmpl$$2();return insert(t,()=>i.children),createRenderEffect(()=>className(t,styles.modal)),t})(),SettingsButton=()=>{const i=useUIState(),[t,n]=createSignal(!1);return[createComponent(Button,{onClick:()=>{n(s=>!s)},children:"Settings"}),createComponent(Portal,{get children(){return createComponent(Show,{get when(){return t()},get children(){return createComponent(Modal,{get children(){return createComponent(VStack,{get children(){return["Settings",createComponent(CheckboxLabel,{get children(){return[createComponent(Checkbox,{get value(){return i.showCompleted()},onChange:s=>i.setShowCompleted(s)}),"Show completed"]}}),createComponent(CheckboxLabel,{get children(){return[createComponent(Checkbox,{get value(){return i.shift()},onChange:s=>i.setShift(s)}),"Shift"]}}),createComponent(CheckboxLabel,{get children(){return[createComponent(Checkbox,{get value(){return i.flipHorizontally()},onChange:s=>i.setFlipHorizontally(s)}),"Flip horizontally"]}}),createComponent(CheckboxLabel,{get children(){return[createComponent(Checkbox,{get value(){return i.hideBlockedSubTree()},onChange:s=>i.setHideBlockedSubtree(s)}),"Hide postponed subtrees"]}}),createComponent(Button,{onClick:()=>n(!1),children:"Close"})]}})}})}})}})]};var _tmpl$$1=template("<div><div>");const GlobalControls=()=>{const i=useStore();return(()=>{var t=_tmpl$$1(),n=t.firstChild;return insert(n,createComponent(HStack,{get children(){return[createComponent(SettingsButton,{}),createComponent(Button,{onClick:s=>{const r="tasks.json",l=localStorage.getItem("tasks");if(l){var o=document.createElement("a"),a=new Blob([l],{type:"application/json"});o.href=URL.createObjectURL(a),o.download=r,o.click()}},children:"Save..."}),createComponent(Button,{onClick:s=>{const r=document.createElement("input");r.setAttribute("type","file"),r.click(),r.addEventListener("change",l=>{const o=r.files;if(!o)return;const a=o[0];if(!a)return;const c=new FileReader;c.onload=function(h){if(!h.target)return;const u=h.target.result;i.updateFromJSON(u)},c.readAsText(a)})},children:"Load..."})]}})),createRenderEffect(s=>{var r=styles$1.cont,l=styles$1.controls;return r!==s.e&&className(t,s.e=r),l!==s.t&&className(n,s.t=l),s},{e:void 0,t:void 0}),t})()};var _tmpl$=template("<div>"),_tmpl$2=template("<div><div>");class JGIDAApi{constructor(t,n){this.store=t,this.uistate=n}getCurrent(){const t=this.uistate.openedTask();return t?this.store.getTask(t)():null}setDescription(t,n){t&&this.store.setDescription(t,n)}setResult(t,n){t&&this.store.setResult(t,n)}addTask(t,n){const s={title:"",description:"",result:"",isPriorityList:!1};this.store.createTask(t,{...s,...n})}}const App=()=>{const store=new InMemoryStore(1),uistate=new UIState,api=new JGIDAApi(store,uistate);return window.JGIDAAPI=api,window.addEventListener("message",e=>{e.data.type==="API"&&eval(e.data.code)}),(()=>{var i=_tmpl$();return insert(i,createComponent(StoreContext.Provider,{value:store,get children(){return createComponent(UIStateContext.Provider,{value:uistate,get children(){var t=_tmpl$2(),n=t.firstChild;return insert(t,createComponent(Show,{get when(){return uistate.openedTask()!=null},get children(){var s=_tmpl$();return insert(s,createComponent(TaskFull,{get id(){return uistate.openedTask()}})),createRenderEffect(()=>className(s,styles$h.layoutTask)),s}}),n),insert(n,createComponent(Board,{get id(){return uistate.goalTask()||store.getRootId()}})),insert(t,createComponent(GlobalControls,{}),null),createRenderEffect(s=>{var r=styles$h.layout,l=styles$h.layoutBoard;return r!==s.e&&className(t,s.e=r),l!==s.t&&className(n,s.t=l),s},{e:void 0,t:void 0}),t}})}})),createRenderEffect(()=>className(i,styles$h.App)),i})()},root=document.getElementById("root");render(()=>createComponent(App,{}),root);
